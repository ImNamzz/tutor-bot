{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/THIS%20PC/OneDrive/Documents/College/miscellaneous/VS%20Code%20Miscs/Naver%20Hackathon%202025/nhungConGa/tutor-bot/src/app/components/ui/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\";\r\nimport { twMerge } from \"tailwind-merge\";\r\n\r\nexport function cn(...inputs: ClassValue[]) {\r\n  return twMerge(clsx(inputs));\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,sSAAO,EAAC,IAAA,6QAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 19, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/THIS%20PC/OneDrive/Documents/College/miscellaneous/VS%20Code%20Miscs/Naver%20Hackathon%202025/nhungConGa/tutor-bot/src/app/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\";\r\nimport { Slot } from \"@radix-ui/react-slot\";\r\nimport { cva, type VariantProps } from \"class-variance-authority\";\r\n\r\nimport { cn } from \"./utils\";\r\n\r\nconst buttonVariants = cva(\r\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\r\n  {\r\n    variants: {\r\n      variant: {\r\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\r\n        destructive:\r\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\r\n        outline:\r\n          \"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\r\n        secondary:\r\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\r\n        ghost:\r\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\r\n        link: \"text-primary underline-offset-4 hover:underline\",\r\n      },\r\n      size: {\r\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\r\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\r\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\r\n        icon: \"size-9 rounded-md\",\r\n      },\r\n    },\r\n    defaultVariants: {\r\n      variant: \"default\",\r\n      size: \"default\",\r\n    },\r\n  },\r\n);\r\n\r\nfunction Button({\r\n  className,\r\n  variant,\r\n  size,\r\n  asChild = false,\r\n  ...props\r\n}: React.ComponentProps<\"button\"> &\r\n  VariantProps<typeof buttonVariants> & {\r\n    asChild?: boolean;\r\n  }) {\r\n  const Comp = asChild ? Slot : \"button\";\r\n\r\n  return (\r\n    <Comp\r\n      data-slot=\"button\"\r\n      className={cn(buttonVariants({ variant, size, className }))}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport { Button, buttonVariants };\r\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,uSAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,wSAAI,GAAG;IAE9B,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 76, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/THIS%20PC/OneDrive/Documents/College/miscellaneous/VS%20Code%20Miscs/Naver%20Hackathon%202025/nhungConGa/tutor-bot/src/app/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\";\r\n\r\nimport { cn } from \"./utils\";\r\n\r\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card\"\r\n      className={cn(\r\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-header\"\r\n      className={cn(\r\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <h4\r\n      data-slot=\"card-title\"\r\n      className={cn(\"leading-none\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <p\r\n      data-slot=\"card-description\"\r\n      className={cn(\"text-muted-foreground\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-action\"\r\n      className={cn(\r\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-content\"\r\n      className={cn(\"px-6 [&:last-child]:pb-6\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\r\n  return (\r\n    <div\r\n      data-slot=\"card-footer\"\r\n      className={cn(\"flex items-center px-6 pb-6 [.border-t]:pt-6\", className)}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport {\r\n  Card,\r\n  CardHeader,\r\n  CardFooter,\r\n  CardTitle,\r\n  CardAction,\r\n  CardDescription,\r\n  CardContent,\r\n};\r\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EACX,sEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EACX,mKACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EAAC,gBAAgB;QAC7B,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EAAC,yBAAyB;QACtC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EAAC,4BAA4B;QACzC,GAAG,KAAK;;;;;;AAGf;AAEA,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EAAC,gDAAgD;QAC7D,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 178, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/THIS%20PC/OneDrive/Documents/College/miscellaneous/VS%20Code%20Miscs/Naver%20Hackathon%202025/nhungConGa/tutor-bot/src/app/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\";\r\n\r\nimport { cn } from \"./utils\";\r\n\r\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\r\n  return (\r\n    <textarea\r\n      data-slot=\"textarea\"\r\n      className={cn(\r\n        \"resize-none border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-input-background px-3 py-2 text-base transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    />\r\n  );\r\n}\r\n\r\nexport { Textarea };\r\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,8WAAC;QACC,aAAU;QACV,WAAW,IAAA,6QAAE,EACX,8cACA;QAED,GAAG,KAAK;;;;;;AAGf","debugId":null}},
    {"offset": {"line": 202, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/THIS%20PC/OneDrive/Documents/College/miscellaneous/VS%20Code%20Miscs/Naver%20Hackathon%202025/nhungConGa/tutor-bot/src/app/components/ui/scroll-area.tsx"],"sourcesContent":["\"use client\";\r\n\r\nimport * as React from \"react\";\r\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\";\r\n\r\nimport { cn } from \"./utils\";\r\n\r\nfunction ScrollArea({\r\n  className,\r\n  children,\r\n  ...props\r\n}: React.ComponentProps<typeof ScrollAreaPrimitive.Root>) {\r\n  return (\r\n    <ScrollAreaPrimitive.Root\r\n      data-slot=\"scroll-area\"\r\n      className={cn(\"relative\", className)}\r\n      {...props}\r\n    >\r\n      <ScrollAreaPrimitive.Viewport\r\n        data-slot=\"scroll-area-viewport\"\r\n        className=\"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1\"\r\n      >\r\n        {children}\r\n      </ScrollAreaPrimitive.Viewport>\r\n      <ScrollBar />\r\n      <ScrollAreaPrimitive.Corner />\r\n    </ScrollAreaPrimitive.Root>\r\n  );\r\n}\r\n\r\nfunction ScrollBar({\r\n  className,\r\n  orientation = \"vertical\",\r\n  ...props\r\n}: React.ComponentProps<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>) {\r\n  return (\r\n    <ScrollAreaPrimitive.ScrollAreaScrollbar\r\n      data-slot=\"scroll-area-scrollbar\"\r\n      orientation={orientation}\r\n      className={cn(\r\n        \"flex touch-none p-px transition-colors select-none\",\r\n        orientation === \"vertical\" &&\r\n          \"h-full w-2.5 border-l border-l-transparent\",\r\n        orientation === \"horizontal\" &&\r\n          \"h-2.5 flex-col border-t border-t-transparent\",\r\n        className,\r\n      )}\r\n      {...props}\r\n    >\r\n      <ScrollAreaPrimitive.ScrollAreaThumb\r\n        data-slot=\"scroll-area-thumb\"\r\n        className=\"bg-border relative flex-1 rounded-full\"\r\n      />\r\n    </ScrollAreaPrimitive.ScrollAreaScrollbar>\r\n  );\r\n}\r\n\r\nexport { ScrollArea, ScrollBar };\r\n"],"names":[],"mappings":";;;;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OACmD;IACtD,qBACE,8WAAC,kTAAwB;QACvB,aAAU;QACV,WAAW,IAAA,6QAAE,EAAC,YAAY;QACzB,GAAG,KAAK;;0BAET,8WAAC,sTAA4B;gBAC3B,aAAU;gBACV,WAAU;0BAET;;;;;;0BAEH,8WAAC;;;;;0BACD,8WAAC,oTAA0B;;;;;;;;;;;AAGjC;AAEA,SAAS,UAAU,EACjB,SAAS,EACT,cAAc,UAAU,EACxB,GAAG,OACkE;IACrE,qBACE,8WAAC,iUAAuC;QACtC,aAAU;QACV,aAAa;QACb,WAAW,IAAA,6QAAE,EACX,sDACA,gBAAgB,cACd,8CACF,gBAAgB,gBACd,gDACF;QAED,GAAG,KAAK;kBAET,cAAA,8WAAC,6TAAmC;YAClC,aAAU;YACV,WAAU;;;;;;;;;;;AAIlB","debugId":null}},
    {"offset": {"line": 290, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/THIS%20PC/OneDrive/Documents/College/miscellaneous/VS%20Code%20Miscs/Naver%20Hackathon%202025/nhungConGa/tutor-bot/src/app/lib/auth.ts"],"sourcesContent":["// Authentication utility functions\r\n\r\nexport const getAccessToken = (): string | null => {\r\n  if (typeof window === \"undefined\") return null;\r\n  return localStorage.getItem(\"access_token\");\r\n};\r\n\r\nexport const setAccessToken = (token: string): void => {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.setItem(\"access_token\", token);\r\n};\r\n\r\nexport const removeAccessToken = (): void => {\r\n  if (typeof window === \"undefined\") return;\r\n  localStorage.removeItem(\"access_token\");\r\n};\r\n\r\nexport const isAuthenticated = (): boolean => {\r\n  return !!getAccessToken();\r\n};\r\n\r\nexport const getAuthHeaders = (): HeadersInit => {\r\n  const token = getAccessToken();\r\n  return {\r\n    \"Content-Type\": \"application/json\",\r\n    ...(token && { Authorization: `Bearer ${token}` }),\r\n  };\r\n};\r\n\r\nexport const handleAuthError = (status: number): void => {\r\n  if (status === 401) {\r\n    // Unauthorized - token expired or invalid\r\n    removeAccessToken();\r\n    window.location.href = \"/auth/login\";\r\n  }\r\n};\r\n"],"names":[],"mappings":"AAAA,mCAAmC;;;;;;;;;;;;;;;AAE5B,MAAM,iBAAiB;IAC5B,wCAAmC,OAAO;;;AAE5C;AAEO,MAAM,iBAAiB,CAAC;IAC7B,wCAAmC;;;AAErC;AAEO,MAAM,oBAAoB;IAC/B,wCAAmC;;;AAErC;AAEO,MAAM,kBAAkB;IAC7B,OAAO,CAAC,CAAC;AACX;AAEO,MAAM,iBAAiB;IAC5B,MAAM,QAAQ;IACd,OAAO;QACL,gBAAgB;QAChB,GAAI,SAAS;YAAE,eAAe,CAAC,OAAO,EAAE,OAAO;QAAC,CAAC;IACnD;AACF;AAEO,MAAM,kBAAkB,CAAC;IAC9B,IAAI,WAAW,KAAK;QAClB,0CAA0C;QAC1C;QACA,OAAO,QAAQ,CAAC,IAAI,GAAG;IACzB;AACF","debugId":null}},
    {"offset": {"line": 343, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/THIS%20PC/OneDrive/Documents/College/miscellaneous/VS%20Code%20Miscs/Naver%20Hackathon%202025/nhungConGa/tutor-bot/src/app/lib/config.ts"],"sourcesContent":["// Environment configuration\r\nexport const config = {\r\n  apiUrl: process.env.NEXT_PUBLIC_API_URL || 'http://localhost:8000',\r\n}\r\n\r\n// API endpoints\r\nexport const API_ENDPOINTS = {\r\n  // Authentication\r\n  register: `${config.apiUrl}/api/register`,\r\n  login: `${config.apiUrl}/api/login`,\r\n  verifyEmail: (token: string) => `${config.apiUrl}/api/verify_email/${token}`,\r\n  resendVerification: `${config.apiUrl}/api/resend_verification`,\r\n  \r\n  // Chat\r\n  startSession: `${config.apiUrl}/api/start_session`,\r\n  chat: `${config.apiUrl}/api/chat`,\r\n}\r\n"],"names":[],"mappings":"AAAA,4BAA4B;;;;;;;AACrB,MAAM,SAAS;IACpB,QAAQ,QAAQ,GAAG,CAAC,mBAAmB,IAAI;AAC7C;AAGO,MAAM,gBAAgB;IAC3B,iBAAiB;IACjB,UAAU,GAAG,OAAO,MAAM,CAAC,aAAa,CAAC;IACzC,OAAO,GAAG,OAAO,MAAM,CAAC,UAAU,CAAC;IACnC,aAAa,CAAC,QAAkB,GAAG,OAAO,MAAM,CAAC,kBAAkB,EAAE,OAAO;IAC5E,oBAAoB,GAAG,OAAO,MAAM,CAAC,wBAAwB,CAAC;IAE9D,OAAO;IACP,cAAc,GAAG,OAAO,MAAM,CAAC,kBAAkB,CAAC;IAClD,MAAM,GAAG,OAAO,MAAM,CAAC,SAAS,CAAC;AACnC","debugId":null}},
    {"offset": {"line": 367, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/THIS%20PC/OneDrive/Documents/College/miscellaneous/VS%20Code%20Miscs/Naver%20Hackathon%202025/nhungConGa/tutor-bot/src/app/page.tsx"],"sourcesContent":["// File: src/app/page.tsx\r\n// AI Tutor on Home Page - All-in-one version\r\n\r\n'use client'\r\n\r\nimport { useState, useRef, useEffect } from 'react'\r\nimport { Button } from '@/app/components/ui/button'\r\nimport { Card } from '@/app/components/ui/card'\r\nimport { Input } from '@/app/components/ui/input'\r\nimport { Textarea } from '@/app/components/ui/textarea'\r\nimport { ScrollArea } from '@/app/components/ui/scroll-area'\r\nimport { Badge } from '@/app/components/ui/badge'\r\nimport { Upload, Send, Loader2, Bot, User, FileText, Sparkles, Clock, MessageSquare, Trash2, PanelLeftClose, PanelLeftOpen, BookOpen, Moon, Sun, Calendar, CheckSquare, LogOut, UserCircle, Plus, ChevronRight, Paperclip, Image, Lock, MoreVertical, Pin, Edit2, ArrowDown } from 'lucide-react'\r\nimport { toast } from 'sonner'\r\nimport Link from 'next/link'\r\nimport { useRouter, usePathname } from 'next/navigation'\r\nimport { isAuthenticated, removeAccessToken, getAccessToken, handleAuthError } from '@/app/lib/auth'\r\nimport { API_ENDPOINTS } from '@/app/lib/config'\r\n\r\ninterface Message {\r\n  id: string\r\n  role: 'user' | 'assistant'\r\n  content: string\r\n  timestamp: Date\r\n}\r\n\r\ntype ChatState = 'idle' | 'uploaded' | 'quizzing' | 'completed'\r\n\r\ninterface TranscriptSession {\r\n  id: string\r\n  fileName: string\r\n  content: string\r\n  keyPoints: string[]\r\n  messages: Message[]\r\n  score?: number\r\n  pinned?: boolean\r\n  createdAt: Date\r\n  updatedAt: Date\r\n}\r\n\r\nexport default function Home() {\r\n  const router = useRouter()\r\n  const pathname = usePathname()\r\n  \r\n  // Theme state\r\n  const [isDarkMode, setIsDarkMode] = useState(false)\r\n  const [isAuth, setIsAuth] = useState(false)\r\n  \r\n  // Chat state\r\n  const [messages, setMessages] = useState<Message[]>([])\r\n  const [inputMessage, setInputMessage] = useState('')\r\n  const [isLoading, setIsLoading] = useState(false)\r\n  const [chatState, setChatState] = useState<ChatState>('idle')\r\n  const [fileName, setFileName] = useState<string>('')\r\n  const [transcriptContent, setTranscriptContent] = useState<string>('')\r\n  const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0)\r\n  const [totalQuestions, setTotalQuestions] = useState(3)\r\n  const [correctAnswers, setCorrectAnswers] = useState(0)\r\n  const [keyPoints, setKeyPoints] = useState<string[]>([])\r\n  const [sessions, setSessions] = useState<TranscriptSession[]>([])\r\n  const [currentSessionId, setCurrentSessionId] = useState<string>('')\r\n  const [isSidebarOpen, setIsSidebarOpen] = useState(true)\r\n  const [mounted, setMounted] = useState(false)\r\n  const [showUploadMenu, setShowUploadMenu] = useState(false)\r\n  const [openSessionMenu, setOpenSessionMenu] = useState<string | null>(null)\r\n  const [renamingSessionId, setRenamingSessionId] = useState<string | null>(null)\r\n  const [newSessionName, setNewSessionName] = useState('')\r\n  const [editingMessageId, setEditingMessageId] = useState<string | null>(null)\r\n  const [editedMessageContent, setEditedMessageContent] = useState('')\r\n  const [hoveredMessageId, setHoveredMessageId] = useState<string | null>(null)\r\n  const [showScrollButton, setShowScrollButton] = useState(false)\r\n  \r\n  const fileInputRef = useRef<HTMLInputElement>(null)\r\n  const imageInputRef = useRef<HTMLInputElement>(null)\r\n  const messagesEndRef = useRef<HTMLDivElement>(null)\r\n  const textareaRef = useRef<HTMLTextAreaElement>(null)\r\n  const uploadMenuRef = useRef<HTMLDivElement>(null)\r\n  const sessionMenuRef = useRef<HTMLDivElement>(null)\r\n  const editTextareaRef = useRef<HTMLTextAreaElement>(null)\r\n  const scrollAreaRef = useRef<HTMLDivElement>(null)\r\n\r\n  // Handle client-side only mounting\r\n  useEffect(() => {\r\n    setMounted(true)\r\n    \r\n    // Check authentication (but don't require it)\r\n    const authenticated = isAuthenticated()\r\n    setIsAuth(authenticated)\r\n    \r\n    const savedTheme = localStorage.getItem('theme')\r\n    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches\r\n    setIsDarkMode(savedTheme === 'dark' || (!savedTheme && prefersDark))\r\n    \r\n    const savedSidebar = localStorage.getItem('sidebarOpen')\r\n    if (savedSidebar !== null) {\r\n      setIsSidebarOpen(savedSidebar === 'true')\r\n    }\r\n  }, [])\r\n\r\n  // Handle theme changes\r\n  useEffect(() => {\r\n    if (!mounted) return\r\n    \r\n    if (isDarkMode) {\r\n      document.documentElement.classList.add('dark')\r\n      localStorage.setItem('theme', 'dark')\r\n    } else {\r\n      document.documentElement.classList.remove('dark')\r\n      localStorage.setItem('theme', 'light')\r\n    }\r\n  }, [isDarkMode, mounted])\r\n\r\n  useEffect(() => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\r\n    setShowScrollButton(false)\r\n  }, [messages])\r\n\r\n  const scrollToBottom = () => {\r\n    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' })\r\n    setShowScrollButton(false)\r\n  }\r\n\r\n  // Save sidebar state to localStorage\r\n  useEffect(() => {\r\n    if (mounted) {\r\n      localStorage.setItem('sidebarOpen', String(isSidebarOpen))\r\n    }\r\n  }, [isSidebarOpen, mounted])\r\n\r\n  // Close upload menu when clicking outside\r\n  useEffect(() => {\r\n    const handleClickOutside = (event: MouseEvent) => {\r\n      if (uploadMenuRef.current && !uploadMenuRef.current.contains(event.target as Node)) {\r\n        setShowUploadMenu(false)\r\n      }\r\n      if (sessionMenuRef.current && !sessionMenuRef.current.contains(event.target as Node)) {\r\n        setOpenSessionMenu(null)\r\n      }\r\n    }\r\n\r\n    if (showUploadMenu || openSessionMenu) {\r\n      document.addEventListener('mousedown', handleClickOutside)\r\n    }\r\n\r\n    return () => {\r\n      document.removeEventListener('mousedown', handleClickOutside)\r\n    }\r\n  }, [showUploadMenu, openSessionMenu])\r\n\r\n  const toggleTheme = () => {\r\n    setIsDarkMode(!isDarkMode)\r\n  }\r\n\r\n  const handleLogout = () => {\r\n    removeAccessToken()\r\n    toast.success('Signed out successfully')\r\n    router.push('/auth/login')\r\n  }\r\n\r\n  const addMessage = (role: 'user' | 'assistant', content: string) => {\r\n    const newMessage: Message = {\r\n      id: Date.now().toString() + Math.random(),\r\n      role,\r\n      content,\r\n      timestamp: new Date(),\r\n    }\r\n    setMessages(prev => [...prev, newMessage])\r\n  }\r\n\r\n  const generateSessionName = async (content: string): Promise<string> => {\r\n    try {\r\n      // Generate a concise session name based on content\r\n      const response = await fetch(API_ENDPOINTS.chat, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${getAccessToken()}`\r\n        },\r\n        body: JSON.stringify({\r\n          chat_session_id: null,\r\n          message: `Generate a very short, concise title (3-5 words max) for a chat session based on this content: \"${content.substring(0, 200)}...\". Only respond with the title, nothing else.`\r\n        })\r\n      })\r\n\r\n      if (response.ok) {\r\n        const data = await response.json()\r\n        // Clean up the response and limit length\r\n        let title = data.response.replace(/['\"]/g, '').trim()\r\n        if (title.length > 50) {\r\n          title = title.substring(0, 47) + '...'\r\n        }\r\n        // Store the session ID if returned\r\n        if (data.chat_session_id) {\r\n          setCurrentSessionId(data.chat_session_id.toString())\r\n        }\r\n        return title\r\n      }\r\n    } catch (error) {\r\n      console.error('Error generating session name:', error)\r\n    }\r\n    \r\n    // Fallback to a default name with timestamp\r\n    return `Chat Session ${new Date().toLocaleString('en-US', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' })}`\r\n  }\r\n\r\n  const handleFileUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0]\r\n    if (!file) return\r\n\r\n    const validExtensions = ['.txt', '.doc', '.docx']\r\n    const fileExtension = file.name.toLowerCase().substring(file.name.lastIndexOf('.'))\r\n    \r\n    if (!validExtensions.includes(fileExtension)) {\r\n      toast.error('Please upload a .txt, .doc, or .docx file')\r\n      return\r\n    }\r\n\r\n    // Save current session before starting new one\r\n    if (chatState !== 'idle') {\r\n      saveCurrentSession()\r\n    }\r\n\r\n    // Reset for new session\r\n    setMessages([])\r\n    setCurrentQuestionIndex(0)\r\n    setCorrectAnswers(0)\r\n    setFileName(file.name)\r\n    setIsLoading(true)\r\n    \r\n    addMessage('user', `ðŸ“Ž Uploaded: ${file.name}`)\r\n    \r\n    // For .doc and .docx files, send directly to backend for processing\r\n    if (fileExtension === '.doc' || fileExtension === '.docx') {\r\n      try {\r\n        const formData = new FormData()\r\n        formData.append('file', file)\r\n        \r\n        // Send file to backend - backend should handle doc/docx parsing\r\n        const response = await fetch(API_ENDPOINTS.startSession, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Authorization': `Bearer ${getAccessToken()}`\r\n          },\r\n          body: formData\r\n        })\r\n\r\n        if (!response.ok) {\r\n          if (response.status === 401) {\r\n            handleAuthError(401)\r\n            return\r\n          }\r\n          throw new Error('Failed to start session')\r\n        }\r\n\r\n        const data = await response.json()\r\n        \r\n        // Set the session ID from backend\r\n        setCurrentSessionId(data.chat_session_id.toString())\r\n        \r\n        // Generate AI-based session name in the background\r\n        generateSessionName(data.transcript || file.name).then(generatedName => {\r\n          setFileName(generatedName)\r\n        })\r\n        \r\n        setTranscriptContent(data.transcript || '')\r\n        \r\n        addMessage('assistant', \r\n          `Great! I've analyzed your document. I found several key concepts that we should discuss.\\n\\nLet me ask you some questions to check your understanding. This will help reinforce your learning! ðŸ“š\\n\\nReady? Here's the first question:`\r\n        )\r\n        \r\n        await new Promise(resolve => setTimeout(resolve, 500))\r\n        \r\n        // Use the first question from the backend\r\n        addMessage('assistant', data.first_question)\r\n        \r\n        setChatState('quizzing')\r\n        setIsLoading(false)\r\n        toast.success('Document processed! Answer the questions to proceed.')\r\n        \r\n      } catch (error) {\r\n        console.error('Error processing document:', error)\r\n        toast.error('Failed to process document. Please try again.')\r\n        setIsLoading(false)\r\n        \r\n        // Reset to idle state on error\r\n        setMessages([])\r\n        setChatState('idle')\r\n        setFileName('')\r\n        addMessage('assistant', \r\n          \"Sorry, I encountered an error processing your document. Please make sure the backend server is running and supports .doc/.docx files.\"\r\n        )\r\n      }\r\n      return\r\n    }\r\n    \r\n    // For .txt files, read as text\r\n    const reader = new FileReader()\r\n    reader.onload = async (e) => {\r\n      const content = e.target?.result as string\r\n      setTranscriptContent(content)\r\n      \r\n      addMessage('user', `ðŸ“Ž Uploaded: ${file.name}`)\r\n      \r\n      try {\r\n        // Call the real backend API to start a session\r\n        const response = await fetch(API_ENDPOINTS.startSession, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Bearer ${getAccessToken()}`\r\n          },\r\n          body: JSON.stringify({\r\n            title: file.name,\r\n            transcript: content\r\n          })\r\n        })\r\n\r\n        if (!response.ok) {\r\n          if (response.status === 401) {\r\n            handleAuthError(401)\r\n            return\r\n          }\r\n          throw new Error('Failed to start session')\r\n        }\r\n\r\n        const data = await response.json()\r\n        \r\n        // Set the session ID from backend\r\n        setCurrentSessionId(data.chat_session_id.toString())\r\n        \r\n        // Generate AI-based session name in the background\r\n        generateSessionName(content).then(generatedName => {\r\n          setFileName(generatedName)\r\n        })\r\n        \r\n        addMessage('assistant', \r\n          `Great! I've analyzed your lecture transcript. I found several key concepts that we should discuss.\\n\\nLet me ask you some questions to check your understanding. This will help reinforce your learning! ðŸ“š\\n\\nReady? Here's the first question:`\r\n        )\r\n        \r\n        await new Promise(resolve => setTimeout(resolve, 500))\r\n        \r\n        // Use the first question from the backend\r\n        addMessage('assistant', data.first_question)\r\n        \r\n        setChatState('quizzing')\r\n        setIsLoading(false)\r\n        toast.success('Transcript processed! Answer the questions to proceed.')\r\n        \r\n      } catch (error) {\r\n        console.error('Error starting session:', error)\r\n        toast.error('Failed to process transcript. Please try again.')\r\n        setIsLoading(false)\r\n        \r\n        // Reset to idle state on error\r\n        setMessages([])\r\n        setChatState('idle')\r\n        setFileName('')\r\n        addMessage('assistant', \r\n          \"Sorry, I encountered an error processing your file. Please make sure the backend server is running and try again.\"\r\n        )\r\n      }\r\n    }\r\n    \r\n    reader.readAsText(file)\r\n  }\r\n\r\n  const handleImageUpload = async (event: React.ChangeEvent<HTMLInputElement>) => {\r\n    const file = event.target.files?.[0]\r\n    if (!file) return\r\n\r\n    if (!file.type.startsWith('image/')) {\r\n      toast.error('Please upload an image file')\r\n      return\r\n    }\r\n\r\n    addMessage('user', `ðŸ–¼ï¸ Uploaded image: ${file.name}`)\r\n    \r\n    // For now, just show a message that image processing is coming soon\r\n    // You can implement actual image processing with your backend later\r\n    addMessage('assistant', \r\n      `I've received your image \"${file.name}\". Image analysis functionality will be available soon! For now, you can describe what you'd like to know about this image, and I'll help you with that.`\r\n    )\r\n    \r\n    setShowUploadMenu(false)\r\n    toast.success('Image uploaded!')\r\n  }\r\n\r\n  const handleSendMessage = async () => {\r\n    if (!inputMessage.trim()) return\r\n\r\n    const userMessage = inputMessage.trim()\r\n    setInputMessage('')\r\n    addMessage('user', userMessage)\r\n    setIsLoading(true)\r\n\r\n    if (chatState === 'idle') {\r\n      // User is starting a new session without uploading a file\r\n      // Send to backend to create a proper session\r\n      setFileName('Chat Session')\r\n      \r\n      try {\r\n        const response = await fetch(API_ENDPOINTS.chat, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Bearer ${getAccessToken()}`\r\n          },\r\n          body: JSON.stringify({\r\n            chat_session_id: null, // Let backend create a new session\r\n            message: userMessage\r\n          })\r\n        })\r\n\r\n        if (!response.ok) {\r\n          if (response.status === 401) {\r\n            handleAuthError(401)\r\n            return\r\n          }\r\n          throw new Error('Failed to send message')\r\n        }\r\n\r\n        const data = await response.json()\r\n        \r\n        // Update session ID from backend and set state to completed\r\n        setCurrentSessionId(data.chat_session_id.toString())\r\n        setChatState('completed') // Now in conversation mode\r\n        \r\n        // Generate AI-based session name from the first message\r\n        generateSessionName(userMessage).then(generatedName => {\r\n          setFileName(generatedName)\r\n        })\r\n        \r\n        // Display AI's response\r\n        addMessage('assistant', data.response)\r\n        \r\n        setIsLoading(false)\r\n        \r\n      } catch (error) {\r\n        console.error('Error sending message:', error)\r\n        toast.error('Failed to send message. Please try again.')\r\n        \r\n        addMessage('assistant', \r\n          \"Sorry, I encountered an error processing your message. Please make sure the backend server is running and try again.\"\r\n        )\r\n        \r\n        setIsLoading(false)\r\n      }\r\n      return\r\n    }\r\n\r\n    // For both quizzing and completed states, use the /api/chat endpoint\r\n    if (chatState === 'quizzing' || chatState === 'completed') {\r\n      try {\r\n        const response = await fetch(API_ENDPOINTS.chat, {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Bearer ${getAccessToken()}`\r\n          },\r\n          body: JSON.stringify({\r\n            chat_session_id: currentSessionId ? Number(currentSessionId) : null,\r\n            message: userMessage\r\n          })\r\n        })\r\n\r\n        if (!response.ok) {\r\n          if (response.status === 401) {\r\n            handleAuthError(401)\r\n            return\r\n          }\r\n          throw new Error('Failed to send message')\r\n        }\r\n\r\n        const data = await response.json()\r\n        \r\n        // Update session ID from backend (in case it was created or changed)\r\n        if (data.chat_session_id) {\r\n          setCurrentSessionId(data.chat_session_id.toString())\r\n        }\r\n        \r\n        // Display AI's response\r\n        addMessage('assistant', data.response)\r\n        \r\n        setIsLoading(false)\r\n        \r\n      } catch (error) {\r\n        console.error('Error sending message:', error)\r\n        toast.error('Failed to send message. Please try again.')\r\n        \r\n        addMessage('assistant', \r\n          \"Sorry, I encountered an error processing your message. Please make sure the backend server is running and try again.\"\r\n        )\r\n        \r\n        setIsLoading(false)\r\n      }\r\n      return\r\n    }\r\n\r\n    setIsLoading(false)\r\n  }\r\n\r\n  const handleCopyMessage = (content: string) => {\r\n    navigator.clipboard.writeText(content)\r\n    toast.success('Message copied to clipboard!')\r\n  }\r\n\r\n  const handleStartEditMessage = (messageId: string, content: string) => {\r\n    setEditingMessageId(messageId)\r\n    setEditedMessageContent(content)\r\n  }\r\n\r\n  const handleCancelEdit = () => {\r\n    setEditingMessageId(null)\r\n    setEditedMessageContent('')\r\n  }\r\n\r\n  const handleSaveEdit = async (messageId: string) => {\r\n    if (!editedMessageContent.trim()) return\r\n\r\n    // Find the message index\r\n    const messageIndex = messages.findIndex(m => m.id === messageId)\r\n    if (messageIndex === -1) return\r\n\r\n    // Update the message\r\n    const updatedMessages = [...messages]\r\n    updatedMessages[messageIndex] = {\r\n      ...updatedMessages[messageIndex],\r\n      content: editedMessageContent.trim()\r\n    }\r\n\r\n    // Remove all messages after the edited one\r\n    const messagesToKeep = updatedMessages.slice(0, messageIndex + 1)\r\n    setMessages(messagesToKeep)\r\n    \r\n    setEditingMessageId(null)\r\n    setEditedMessageContent('')\r\n    setIsLoading(true)\r\n\r\n    // Get AI response to the edited message\r\n    try {\r\n      const response = await fetch(API_ENDPOINTS.chat, {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Authorization': `Bearer ${getAccessToken()}`\r\n        },\r\n        body: JSON.stringify({\r\n          chat_session_id: currentSessionId ? Number(currentSessionId) : null,\r\n          message: editedMessageContent.trim()\r\n        })\r\n      })\r\n\r\n      if (!response.ok) {\r\n        if (response.status === 401) {\r\n          handleAuthError(401)\r\n          return\r\n        }\r\n        throw new Error('Failed to get response')\r\n      }\r\n\r\n      const data = await response.json()\r\n      \r\n      // Add AI response\r\n      addMessage('assistant', data.response)\r\n      \r\n      setIsLoading(false)\r\n    } catch (error) {\r\n      console.error('Error getting AI response:', error)\r\n      toast.error('Failed to get AI response. Please try again.')\r\n      addMessage('assistant', \r\n        \"Sorry, I encountered an error processing your edited message. Please try again.\"\r\n      )\r\n      setIsLoading(false)\r\n    }\r\n  }\r\n\r\n  const saveCurrentSession = () => {\r\n    if (!mounted || chatState === 'idle' || !fileName || messages.length <= 1) return\r\n\r\n    const score = chatState === 'completed' \r\n      ? Math.round((correctAnswers / totalQuestions) * 100) \r\n      : undefined\r\n\r\n    const session: TranscriptSession = {\r\n      id: currentSessionId || `session_${Date.now()}`,\r\n      fileName,\r\n      content: transcriptContent,\r\n      keyPoints,\r\n      messages: messages.map(m => ({ ...m, timestamp: new Date(m.timestamp) })),\r\n      score,\r\n      createdAt: new Date(),\r\n      updatedAt: new Date(),\r\n    }\r\n\r\n    const existingSessions = JSON.parse(localStorage.getItem('chatSessions') || '[]')\r\n    const sessionIndex = existingSessions.findIndex((s: TranscriptSession) => s.id === session.id)\r\n    \r\n    if (sessionIndex >= 0) {\r\n      existingSessions[sessionIndex] = session\r\n    } else {\r\n      existingSessions.unshift(session)\r\n    }\r\n\r\n    const trimmedSessions = existingSessions.slice(0, 20)\r\n    localStorage.setItem('chatSessions', JSON.stringify(trimmedSessions))\r\n    setSessions(trimmedSessions)\r\n  }\r\n\r\n  const loadSessions = () => {\r\n    if (!mounted) return\r\n    \r\n    try {\r\n      const savedSessions = localStorage.getItem('chatSessions')\r\n      if (savedSessions) {\r\n        const parsed = JSON.parse(savedSessions)\r\n        const validSessions = parsed.map((s: any) => ({\r\n          ...s,\r\n          createdAt: s.createdAt ? new Date(s.createdAt) : new Date(),\r\n          updatedAt: s.updatedAt ? new Date(s.updatedAt) : new Date(),\r\n          messages: Array.isArray(s.messages) ? s.messages.map((m: any) => ({ \r\n            ...m, \r\n            timestamp: m.timestamp ? new Date(m.timestamp) : new Date() \r\n          })) : [],\r\n        }))\r\n        setSessions(validSessions)\r\n      }\r\n    } catch (error) {\r\n      console.error('Error loading sessions:', error)\r\n      setSessions([])\r\n    }\r\n  }\r\n\r\n  const handleLoadSession = (session: TranscriptSession) => {\r\n    try {\r\n      setMessages(session.messages || [])\r\n      setFileName(session.fileName || 'Untitled')\r\n      setTranscriptContent(session.content || '')\r\n      setKeyPoints(session.keyPoints || [])\r\n      setCurrentSessionId(session.id)\r\n      \r\n      if (session.score !== undefined) {\r\n        setChatState('completed')\r\n      } else {\r\n        setChatState('quizzing')\r\n      }\r\n      \r\n      toast.success('Session loaded!')\r\n    } catch (error) {\r\n      console.error('Error loading session:', error)\r\n      toast.error('Failed to load session')\r\n    }\r\n  }\r\n\r\n  const handleDeleteSession = (e: React.MouseEvent, sessionId: string) => {\r\n    e.stopPropagation()\r\n    \r\n    if (!mounted) return\r\n    \r\n    const savedSessions = JSON.parse(localStorage.getItem('chatSessions') || '[]')\r\n    const filtered = savedSessions.filter((s: TranscriptSession) => s.id !== sessionId)\r\n    localStorage.setItem('chatSessions', JSON.stringify(filtered))\r\n    setSessions(filtered)\r\n    \r\n    // If user is deleting the currently active session, create a new session\r\n    if (sessionId === currentSessionId) {\r\n      setMessages([])\r\n      setChatState('idle')\r\n      setFileName('')\r\n      setTranscriptContent('')\r\n      setCurrentQuestionIndex(0)\r\n      setCorrectAnswers(0)\r\n      setKeyPoints([])\r\n      setCurrentSessionId('')\r\n      if (fileInputRef.current) {\r\n        fileInputRef.current.value = ''\r\n      }\r\n      addMessage('assistant', \r\n        \"Your previous session has been deleted. Feel free to start a new conversation or upload a file! ðŸ“š\"\r\n      )\r\n    }\r\n    \r\n    toast.success('Session deleted')\r\n  }\r\n\r\n  const handlePinSession = (e: React.MouseEvent, sessionId: string) => {\r\n    e.stopPropagation()\r\n    setOpenSessionMenu(null)\r\n    \r\n    if (!mounted) return\r\n    \r\n    const savedSessions = JSON.parse(localStorage.getItem('chatSessions') || '[]')\r\n    const updated = savedSessions.map((s: TranscriptSession) => \r\n      s.id === sessionId ? { ...s, pinned: !s.pinned } : s\r\n    )\r\n    localStorage.setItem('chatSessions', JSON.stringify(updated))\r\n    setSessions(updated)\r\n    \r\n    const session = updated.find((s: TranscriptSession) => s.id === sessionId)\r\n    toast.success(session?.pinned ? 'Session pinned' : 'Session unpinned')\r\n  }\r\n\r\n  const handleRenameSession = (e: React.MouseEvent, sessionId: string) => {\r\n    e.stopPropagation()\r\n    setOpenSessionMenu(null)\r\n    \r\n    const session = sessions.find(s => s.id === sessionId)\r\n    if (session) {\r\n      setRenamingSessionId(sessionId)\r\n      setNewSessionName(session.fileName)\r\n    }\r\n  }\r\n\r\n  const saveRename = (sessionId: string) => {\r\n    if (!mounted || !newSessionName.trim()) return\r\n    \r\n    const savedSessions = JSON.parse(localStorage.getItem('chatSessions') || '[]')\r\n    const updated = savedSessions.map((s: TranscriptSession) => \r\n      s.id === sessionId ? { ...s, fileName: newSessionName.trim() } : s\r\n    )\r\n    localStorage.setItem('chatSessions', JSON.stringify(updated))\r\n    setSessions(updated)\r\n    \r\n    if (sessionId === currentSessionId) {\r\n      setFileName(newSessionName.trim())\r\n    }\r\n    \r\n    setRenamingSessionId(null)\r\n    setNewSessionName('')\r\n    toast.success('Session renamed')\r\n  }\r\n\r\n  const cancelRename = () => {\r\n    setRenamingSessionId(null)\r\n    setNewSessionName('')\r\n  }\r\n\r\n  const handleReset = () => {\r\n    saveCurrentSession()\r\n    \r\n    setMessages([])\r\n    setChatState('idle')\r\n    setFileName('')\r\n    setTranscriptContent('')\r\n    setCurrentQuestionIndex(0)\r\n    setCorrectAnswers(0)\r\n    setKeyPoints([])\r\n    setCurrentSessionId('')\r\n    if (fileInputRef.current) {\r\n      fileInputRef.current.value = ''\r\n    }\r\n    addMessage('assistant', \r\n      \"Welcome back! Upload a new lecture transcript to start a fresh learning session. ðŸ“š\"\r\n    )\r\n  }\r\n\r\n  const formatRelativeTime = (date: Date | string): string => {\r\n    try {\r\n      const dateObj = date instanceof Date ? date : new Date(date)\r\n      if (isNaN(dateObj.getTime())) {\r\n        return 'Unknown'\r\n      }\r\n      \r\n      const now = new Date()\r\n      const diffMs = now.getTime() - dateObj.getTime()\r\n      const diffMins = Math.floor(diffMs / 60000)\r\n      const diffHours = Math.floor(diffMs / 3600000)\r\n      const diffDays = Math.floor(diffMs / 86400000)\r\n\r\n      if (diffMins < 1) return 'Just now'\r\n      if (diffMins < 60) return `${diffMins}m ago`\r\n      if (diffHours < 24) return `${diffHours}h ago`\r\n      if (diffDays < 7) return `${diffDays}d ago`\r\n      \r\n      return dateObj.toLocaleDateString('en-US', { month: 'short', day: 'numeric' })\r\n    } catch (error) {\r\n      return 'Unknown'\r\n    }\r\n  }\r\n\r\n  const categorizeSessionsByTime = () => {\r\n    const now = new Date()\r\n    const categories: { [key: string]: TranscriptSession[] } = {\r\n      'Today': [],\r\n      'Yesterday': [],\r\n      '7 Days': [],\r\n      '30 Days': [],\r\n    }\r\n    \r\n    // Add month categories dynamically\r\n    const months: { [key: string]: TranscriptSession[] } = {}\r\n    \r\n    sessions.forEach(session => {\r\n      const sessionDate = session.updatedAt instanceof Date ? session.updatedAt : new Date(session.updatedAt)\r\n      const diffMs = now.getTime() - sessionDate.getTime()\r\n      const diffDays = Math.floor(diffMs / 86400000)\r\n      \r\n      if (diffDays === 0) {\r\n        categories['Today'].push(session)\r\n      } else if (diffDays === 1) {\r\n        categories['Yesterday'].push(session)\r\n      } else if (diffDays <= 7) {\r\n        categories['7 Days'].push(session)\r\n      } else if (diffDays <= 30) {\r\n        categories['30 Days'].push(session)\r\n      } else {\r\n        const monthKey = sessionDate.toLocaleDateString('en-US', { year: 'numeric', month: '2-digit' })\r\n        if (!months[monthKey]) {\r\n          months[monthKey] = []\r\n        }\r\n        months[monthKey].push(session)\r\n      }\r\n    })\r\n    \r\n    // Remove empty categories\r\n    Object.keys(categories).forEach(key => {\r\n      if (categories[key].length === 0) {\r\n        delete categories[key]\r\n      }\r\n    })\r\n    \r\n    return { ...categories, ...months }\r\n  }\r\n\r\n  // Load sessions on mount\r\n  useEffect(() => {\r\n    if (mounted) {\r\n      loadSessions()\r\n    }\r\n  }, [mounted])\r\n\r\n  // Auto-save session periodically\r\n  useEffect(() => {\r\n    if (mounted && chatState !== 'idle' && fileName) {\r\n      const timer = setTimeout(() => {\r\n        saveCurrentSession()\r\n      }, 5000)\r\n      \r\n      return () => clearTimeout(timer)\r\n    }\r\n  }, [messages, chatState, fileName, mounted])\r\n\r\n  // Initial greeting\r\n  useEffect(() => {\r\n    if (mounted && messages.length === 0) {\r\n      if (!isAuth) {\r\n        // Show sign in prompt if user is not authenticated\r\n        addMessage('assistant', \r\n          \"Hi! I'm your AI learning assistant. ðŸ‘‹\\n\\nðŸ”’ You need to sign in to use the chatbot.\\n\\nPlease sign in or create an account to:\\n\\n1. Upload lecture transcripts and study materials\\n2. Get personalized quizzes based on your content\\n3. Receive AI-powered explanations and summaries\\n4. Save your learning sessions and track progress\\n\\nClick the 'Sign In' or 'Sign Up' button in the top right to get started!\"\r\n        )\r\n      } else {\r\n        // Show normal greeting if user is authenticated\r\n        addMessage('assistant', \r\n          \"Hi! I'm your AI learning assistant. ðŸ‘‹\\n\\nTo get started, please upload a lecture transcript or study material using the upload button above. I'll help you understand the content by:\\n\\n1. Asking you questions to test your comprehension\\n2. Grading your understanding\\n3. Providing key summaries and clarifications\\n4. Answering any questions you have about the material\\n\\nReady to learn? Upload your file to begin!\"\r\n        )\r\n      }\r\n    }\r\n  }, [mounted, isAuth])\r\n\r\n  const handleKeyPress = (e: React.KeyboardEvent) => {\r\n    if (e.key === 'Enter' && !e.shiftKey) {\r\n      e.preventDefault()\r\n      handleSendMessage()\r\n    }\r\n  }\r\n\r\n  const handleInputChange = (e: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n    setInputMessage(e.target.value)\r\n    \r\n    // Auto-resize textarea\r\n    const textarea = e.target\r\n    textarea.style.height = 'auto'\r\n    textarea.style.height = `${textarea.scrollHeight}px`\r\n  }\r\n\r\n  // Auto-resize on mount and when inputMessage changes\r\n  useEffect(() => {\r\n    if (textareaRef.current) {\r\n      textareaRef.current.style.height = 'auto'\r\n      textareaRef.current.style.height = `${textareaRef.current.scrollHeight}px`\r\n    }\r\n  }, [inputMessage])\r\n\r\n  // Handle scroll detection for scroll-to-bottom button\r\n  useEffect(() => {\r\n    const scrollContainer = scrollAreaRef.current?.querySelector('[data-radix-scroll-area-viewport]')\r\n    if (!scrollContainer) return\r\n\r\n    const handleScroll = () => {\r\n      const { scrollTop, scrollHeight, clientHeight } = scrollContainer\r\n      const isNearBottom = scrollHeight - scrollTop - clientHeight < 20\r\n      setShowScrollButton(!isNearBottom && messages.length > 0)\r\n    }\r\n\r\n    scrollContainer.addEventListener('scroll', handleScroll)\r\n    return () => scrollContainer.removeEventListener('scroll', handleScroll)\r\n  }, [messages.length])\r\n\r\n  // Don't render until mounted to prevent hydration issues\r\n  if (!mounted) {\r\n    return null\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-50 dark:bg-[#0f0f0f] transition-colors\">\r\n      {/* Session History Sidebar - Fixed Left Side, Full Height */}\r\n      <div\r\n        className={`fixed left-0 top-0 h-screen z-50 transition-all duration-300 ease-in-out flex flex-col bg-white dark:bg-black border-r border-gray-200 dark:border-[#212121] ${\r\n          isSidebarOpen ? 'w-[280px]' : 'w-16'\r\n        }`}\r\n      >\r\n        {/* Sidebar Header with Toggle */}\r\n        <div className=\"p-4 border-b border-gray-200 dark:border-gray-800 flex items-center justify-between shrink-0\">\r\n          {isSidebarOpen && (\r\n            <span className=\"text-gray-900 dark:text-white font-medium text-sm\">EduAssist</span>\r\n          )}\r\n          <Button\r\n            onClick={() => setIsSidebarOpen(!isSidebarOpen)}\r\n            variant=\"ghost\"\r\n            size=\"sm\"\r\n            className=\"h-8 w-8 p-0 hover:bg-gray-200 dark:hover:bg-gray-800 text-gray-600 dark:text-gray-400\"\r\n            aria-label={isSidebarOpen ? \"Close sidebar\" : \"Open sidebar\"}\r\n          >\r\n            {isSidebarOpen ? <PanelLeftClose className=\"h-4 w-4\" /> : <PanelLeftOpen className=\"h-4 w-4\" />}\r\n          </Button>\r\n        </div>\r\n\r\n        {/* New Chat Button */}\r\n        <div className=\"p-3 border-b border-gray-200 dark:border-gray-800 shrink-0\">\r\n          <Button\r\n            onClick={handleReset}\r\n            className={`w-full justify-start gap-2 bg-gray-200 dark:bg-gray-800 hover:bg-gray-300 dark:hover:bg-gray-700 text-gray-900 dark:text-white border-gray-300 dark:border-gray-700 ${\r\n              !isSidebarOpen ? 'px-2' : ''\r\n            }`}\r\n            variant=\"outline\"\r\n          >\r\n            <Plus className=\"h-4 w-4 shrink-0\" />\r\n            {isSidebarOpen && <span>New chat</span>}\r\n          </Button>\r\n        </div>\r\n        \r\n        {/* Sessions List - Scrollable */}\r\n        <div className=\"flex-1 overflow-hidden\">\r\n          <ScrollArea className=\"h-full\">\r\n            {isSidebarOpen ? (\r\n              <div className=\"p-3 space-y-4\">\r\n                {sessions.length === 0 ? (\r\n                  <div className=\"text-center text-gray-500 dark:text-gray-500 py-8\">\r\n                    <MessageSquare className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\r\n                    <p className=\"text-xs\">No chat history</p>\r\n                  </div>\r\n                ) : (\r\n                  Object.entries(categorizeSessionsByTime()).map(([category, categorySessions]) => (\r\n                    <div key={category} className=\"space-y-2\">\r\n                      <h4 className=\"text-xs font-medium text-gray-600 dark:text-gray-500 px-2\">{category}</h4>\r\n                      {categorySessions.map((session) => {\r\n                        const isActive = session.id === currentSessionId\r\n                        \r\n                        return (\r\n                          <div\r\n                            key={session.id}\r\n                            className={`group relative p-2.5 rounded-lg cursor-pointer transition-all ${\r\n                              isActive \r\n                                ? 'bg-gray-200 dark:bg-gray-800' \r\n                                : 'hover:bg-gray-100 dark:hover:bg-gray-800/50'\r\n                            }`}\r\n                          onClick={() => handleLoadSession(session)}\r\n                        >\r\n                          <div className=\"flex items-start gap-2\">\r\n                            <MessageSquare className=\"h-4 w-4 shrink-0 text-gray-600 dark:text-gray-400 mt-0.5\" />\r\n                            <div className=\"flex-1 min-w-0 pr-8\">\r\n                              {renamingSessionId === session.id ? (\r\n                                <input\r\n                                  type=\"text\"\r\n                                  value={newSessionName}\r\n                                  onChange={(e) => setNewSessionName(e.target.value)}\r\n                                  onKeyDown={(e) => {\r\n                                    if (e.key === 'Enter') saveRename(session.id)\r\n                                    if (e.key === 'Escape') cancelRename()\r\n                                  }}\r\n                                  onBlur={() => saveRename(session.id)}\r\n                                  onClick={(e) => e.stopPropagation()}\r\n                                  className=\"w-full text-sm bg-gray-100 dark:bg-gray-700 text-gray-900 dark:text-gray-200 px-2 py-1 rounded border border-gray-300 dark:border-gray-600 focus:outline-none focus:border-indigo-500\"\r\n                                  autoFocus\r\n                                />\r\n                              ) : (\r\n                                <div className=\"flex items-center gap-1\">\r\n                                  {session.pinned && <Pin className=\"h-3 w-3 text-indigo-600 dark:text-indigo-400\" />}\r\n                                  <p className=\"text-sm text-gray-900 dark:text-gray-200 break-words\">\r\n                                    {session.fileName}\r\n                                  </p>\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                            <div className=\"relative\">\r\n                              <Button\r\n                                onClick={(e: React.MouseEvent) => {\r\n                                  e.stopPropagation()\r\n                                  setOpenSessionMenu(openSessionMenu === session.id ? null : session.id)\r\n                                }}\r\n                                variant=\"ghost\"\r\n                                size=\"sm\"\r\n                                className=\"opacity-0 group-hover:opacity-100 transition-opacity h-6 w-6 p-0 hover:bg-gray-200 dark:hover:bg-gray-700 absolute right-0 top-0\"\r\n                              >\r\n                                <MoreVertical className=\"h-3 w-3 text-gray-600 dark:text-gray-400\" />\r\n                              </Button>\r\n                              \r\n                              {/* Dropdown Menu */}\r\n                              {openSessionMenu === session.id && (\r\n                                <div \r\n                                  ref={sessionMenuRef}\r\n                                  className=\"absolute right-0 top-6 bg-white dark:bg-gray-900 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg overflow-hidden z-50 min-w-[140px]\"\r\n                                  onClick={(e) => e.stopPropagation()}\r\n                                >\r\n                                  <button\r\n                                    onClick={(e) => handlePinSession(e, session.id)}\r\n                                    className=\"w-full px-3 py-2 flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-left text-sm text-gray-900 dark:text-gray-200\"\r\n                                  >\r\n                                    <Pin className=\"h-3 w-3\" />\r\n                                    <span>{session.pinned ? 'Unpin' : 'Pin'}</span>\r\n                                  </button>\r\n                                  <button\r\n                                    onClick={(e) => handleRenameSession(e, session.id)}\r\n                                    className=\"w-full px-3 py-2 flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-left text-sm text-gray-900 dark:text-gray-200\"\r\n                                  >\r\n                                    <Edit2 className=\"h-3 w-3\" />\r\n                                    <span>Rename</span>\r\n                                  </button>\r\n                                  <button\r\n                                    onClick={(e) => handleDeleteSession(e, session.id)}\r\n                                    className=\"w-full px-3 py-2 flex items-center gap-2 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors text-left text-sm text-red-600 dark:text-red-400\"\r\n                                  >\r\n                                    <Trash2 className=\"h-3 w-3\" />\r\n                                    <span>Delete</span>\r\n                                  </button>\r\n                                </div>\r\n                              )}\r\n                            </div>\r\n                          </div>\r\n                        </div>\r\n                      )\r\n                    })}\r\n                  </div>\r\n                ))\r\n              )}\r\n            </div>\r\n          ) : (\r\n            // Minimized view - just icons\r\n            <div className=\"p-2 space-y-2\">\r\n              {sessions.slice(0, 5).map((session) => {\r\n                const isActive = session.id === currentSessionId\r\n                return (\r\n                  <div\r\n                    key={session.id}\r\n                    className={`p-2 rounded-lg cursor-pointer transition-all ${\r\n                      isActive ? 'bg-gray-800' : 'hover:bg-gray-800/50'\r\n                    }`}\r\n                    onClick={() => handleLoadSession(session)}\r\n                    title={session.fileName}\r\n                  >\r\n                    <MessageSquare className=\"h-4 w-4 text-gray-400 mx-auto\" />\r\n                  </div>\r\n                )\r\n              })}\r\n            </div>\r\n          )}\r\n          </ScrollArea>\r\n        </div>\r\n      </div>\r\n\r\n      {/* Main Content Area - Adjusted for sidebar */}\r\n      <div className={`transition-all duration-300 ${isSidebarOpen ? 'ml-[280px]' : 'ml-16'}`}>\r\n        {/* Navigation */}\r\n        <nav className=\"bg-white dark:bg-black shadow-sm border-b border-gray-200 dark:border-[#212121] transition-colors\">\r\n        <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n          <div className=\"flex items-center justify-between h-16\">\r\n            <div className=\"flex items-center gap-8\">\r\n              <Link href=\"/\" className=\"flex items-center hover:opacity-80 transition-opacity\">\r\n                <BookOpen className=\"h-8 w-8 text-indigo-600 dark:text-indigo-400\" />\r\n                <span className=\"ml-2 dark:text-white\">EduAssist</span>\r\n              </Link>\r\n              \r\n              {/* Navigation Links */}\r\n              <div className=\"hidden md:flex items-center gap-6\">\r\n                <Link \r\n                  href=\"/\" \r\n                  className={`hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors flex items-center gap-2 ${\r\n                    pathname === \"/\" \r\n                      ? \"text-indigo-600 dark:text-indigo-400\" \r\n                      : \"text-gray-700 dark:text-gray-300\"\r\n                  }`}\r\n                >\r\n                  <BookOpen className=\"h-4 w-4\" />\r\n                  AI Tutor\r\n                </Link>\r\n                <Link \r\n                  href=\"/calendar\" \r\n                  className={`hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors flex items-center gap-2 ${\r\n                    pathname === \"/calendar\" \r\n                      ? \"text-indigo-600 dark:text-indigo-400\" \r\n                      : \"text-gray-700 dark:text-gray-300\"\r\n                  }`}\r\n                >\r\n                  <Calendar className=\"h-4 w-4\" />\r\n                  Calendar\r\n                </Link>\r\n                <Link \r\n                  href=\"/todo\" \r\n                  className={`hover:text-indigo-700 dark:hover:text-indigo-300 transition-colors flex items-center gap-2 ${\r\n                    pathname === \"/todo\" \r\n                      ? \"text-indigo-600 dark:text-indigo-400\" \r\n                      : \"text-gray-700 dark:text-gray-300\"\r\n                  }`}\r\n                >\r\n                  <CheckSquare className=\"h-4 w-4\" />\r\n                  Todo\r\n                </Link>\r\n              </div>\r\n            </div>\r\n            \r\n            <div className=\"flex items-center gap-3\">\r\n              <Button\r\n                onClick={toggleTheme}\r\n                variant=\"ghost\"\r\n                size=\"sm\"\r\n                className=\"rounded-full w-9 h-9 p-0\"\r\n                aria-label=\"Toggle theme\"\r\n              >\r\n                {isDarkMode ? (\r\n                  <Sun className=\"h-5 w-5 text-gray-300\" />\r\n                ) : (\r\n                  <Moon className=\"h-5 w-5 text-gray-600\" />\r\n                )}\r\n              </Button>\r\n              \r\n              {isAuth ? (\r\n                <Button\r\n                  onClick={handleLogout}\r\n                  variant=\"ghost\"\r\n                  size=\"sm\"\r\n                  className=\"flex items-center gap-2\"\r\n                >\r\n                  <LogOut className=\"h-4 w-4\" />\r\n                  <span className=\"hidden sm:inline\">Sign Out</span>\r\n                </Button>\r\n              ) : (\r\n                <div className=\"flex items-center gap-2\">\r\n                  <Link href=\"/auth/login\">\r\n                    <Button variant=\"ghost\" size=\"sm\">\r\n                      Sign In\r\n                    </Button>\r\n                  </Link>\r\n                  <Link href=\"/auth/register\">\r\n                    <Button size=\"sm\">\r\n                      Sign Up\r\n                    </Button>\r\n                  </Link>\r\n                </div>\r\n              )}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </nav>\r\n\r\n      {/* Page Content */}\r\n      <main className=\"px-4 sm:px-6 lg:px-8 py-8 min-h-[calc(100vh-4rem)]\">\r\n        <div className=\"max-w-[1200px] mx-auto\">\r\n            {/* Main Chat Area */}\r\n            <Card className=\"min-h-[600px] flex flex-col dark:border-gray-800 transition-all duration-300 bg-transparent border-0 shadow-none\">\r\n            {/* Hidden file inputs */}\r\n            <input\r\n              ref={fileInputRef}\r\n              type=\"file\"\r\n              accept=\".txt,.doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document\"\r\n              onChange={handleFileUpload}\r\n              className=\"hidden\"\r\n              id=\"file-upload\"\r\n            />\r\n            <input\r\n              ref={imageInputRef}\r\n              type=\"file\"\r\n              accept=\"image/*\"\r\n              onChange={handleImageUpload}\r\n              className=\"hidden\"\r\n              id=\"image-upload\"\r\n            />\r\n\r\n            {/* Chat Messages */}\r\n            <ScrollArea className=\"flex-1 p-4\" ref={scrollAreaRef}>\r\n              <div className=\"space-y-6\">\r\n                {messages.map((message, index) => (\r\n                  <div\r\n                    key={message.id}\r\n                    className={`group relative ${message.role === 'user' ? 'flex justify-end' : 'flex justify-start'}`}\r\n                    onMouseEnter={() => setHoveredMessageId(message.id)}\r\n                    onMouseLeave={() => setHoveredMessageId(null)}\r\n                  >\r\n                    {editingMessageId === message.id ? (\r\n                      // Edit mode\r\n                      <div className=\"w-full\">\r\n                        <Textarea\r\n                          ref={editTextareaRef}\r\n                          value={editedMessageContent}\r\n                          onChange={(e) => setEditedMessageContent(e.target.value)}\r\n                          className=\"w-full resize-none min-h-[100px] bg-white dark:bg-[#212121] border-2 border-indigo-500 text-gray-900 dark:text-white\"\r\n                          autoFocus\r\n                        />\r\n                        <div className=\"flex gap-2 mt-2 justify-end\">\r\n                          <Button\r\n                            onClick={handleCancelEdit}\r\n                            variant=\"outline\"\r\n                            size=\"sm\"\r\n                          >\r\n                            Cancel\r\n                          </Button>\r\n                          <Button\r\n                            onClick={() => handleSaveEdit(message.id)}\r\n                            size=\"sm\"\r\n                          >\r\n                            Save & Submit\r\n                          </Button>\r\n                        </div>\r\n                      </div>\r\n                    ) : (\r\n                      // Display mode\r\n                      <>\r\n                        <div className={message.role === 'user' ? 'flex flex-col items-end gap-1' : ''}>\r\n                          <div\r\n                            className={`px-4 py-3 ${\r\n                              message.role === 'user'\r\n                                ? 'bg-[#2c2c2e] text-white rounded-2xl max-w-[85%] break-all'\r\n                                : 'text-gray-900 dark:text-gray-100 max-w-[85%]'\r\n                            }`}\r\n                          >\r\n                            <p className=\"whitespace-pre-wrap\">{message.content}</p>\r\n                            {message.role === 'assistant' && (\r\n                              <p className=\"text-xs text-gray-500 dark:text-gray-400 mt-2\">\r\n                                {message.timestamp instanceof Date \r\n                                  ? message.timestamp.toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })\r\n                                  : new Date(message.timestamp).toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' })\r\n                                }\r\n                              </p>\r\n                            )}\r\n                          </div>\r\n\r\n                          {/* Action buttons below user messages */}\r\n                          {message.role === 'user' && (\r\n                            <div className=\"flex gap-2 px-2\">\r\n                              <button\r\n                                onClick={() => handleCopyMessage(message.content)}\r\n                                className=\"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 flex items-center gap-1\"\r\n                                title=\"Copy\"\r\n                              >\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                  <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect>\r\n                                  <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path>\r\n                                </svg>\r\n                                Copy\r\n                              </button>\r\n                              <button\r\n                                onClick={() => handleStartEditMessage(message.id, message.content)}\r\n                                className=\"text-xs text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200 flex items-center gap-1\"\r\n                                title=\"Edit\"\r\n                              >\r\n                                <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                  <path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"></path>\r\n                                  <path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"></path>\r\n                                </svg>\r\n                                Edit\r\n                              </button>\r\n                            </div>\r\n                          )}\r\n                        </div>\r\n\r\n                        {/* Action buttons on hover for AI messages */}\r\n                        {message.role === 'assistant' && hoveredMessageId === message.id && (\r\n                          <div className=\"absolute top-0 left-0 -translate-x-full mr-2 pr-2 flex gap-1 transition-opacity opacity-100\">\r\n                            <Button\r\n                              onClick={() => handleCopyMessage(message.content)}\r\n                              variant=\"ghost\"\r\n                              size=\"sm\"\r\n                              className=\"h-8 w-8 p-0 hover:bg-gray-200 dark:hover:bg-gray-700\"\r\n                              title=\"Copy\"\r\n                            >\r\n                              <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" strokeWidth=\"2\" strokeLinecap=\"round\" strokeLinejoin=\"round\">\r\n                                <rect x=\"9\" y=\"9\" width=\"13\" height=\"13\" rx=\"2\" ry=\"2\"></rect>\r\n                                <path d=\"M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1\"></path>\r\n                              </svg>\r\n                            </Button>\r\n                          </div>\r\n                        )}\r\n                      </>\r\n                    )}\r\n                  </div>\r\n                ))}\r\n                \r\n                {isLoading && (\r\n                  <div className=\"flex justify-start\">\r\n                    <div className=\"px-4 py-3\">\r\n                      <Loader2 className=\"h-5 w-5 text-indigo-600 dark:text-indigo-400 animate-spin\" />\r\n                    </div>\r\n                  </div>\r\n                )}\r\n                \r\n                <div ref={messagesEndRef} />\r\n              </div>\r\n            </ScrollArea>\r\n\r\n            {/* Input Area */}\r\n            <div className=\"sticky bottom-0 p-4 bg-white dark:bg-[#0f0f0f] border-t border-gray-200 dark:border-gray-800\">\r\n              {/* Scroll to bottom button - positioned in input area */}\r\n              {messages.length > 0 && (\r\n                <div className=\"flex justify-end mb-2\">\r\n                  <Button\r\n                    onClick={scrollToBottom}\r\n                    variant=\"outline\"\r\n                    size=\"sm\"\r\n                    className=\"gap-2 text-xs\"\r\n                    title=\"Scroll to latest message\"\r\n                  >\r\n                    <ArrowDown className=\"h-4 w-4\" />\r\n                    Latest message\r\n                  </Button>\r\n                </div>\r\n              )}\r\n              \r\n              <div className=\"flex gap-2 max-w-3xl mx-auto\">\r\n                {/* Upload button with menu or Lock icon */}\r\n                <div className=\"relative\" ref={uploadMenuRef}>\r\n                  <Button \r\n                    type=\"button\"\r\n                    variant=\"outline\" \r\n                    size=\"icon\"\r\n                    onClick={() => isAuth && setShowUploadMenu(!showUploadMenu)}\r\n                    disabled={!isAuth}\r\n                    className={`min-h-11 h-11 ${!isAuth ? \"cursor-not-allowed opacity-50\" : \"\"}`}\r\n                  >\r\n                    {isAuth ? <Plus className=\"h-4 w-4\" /> : <Lock className=\"h-5 w-5\" />}\r\n                  </Button>\r\n                  \r\n                  {/* Upload menu */}\r\n                  {showUploadMenu && isAuth && (\r\n                    <div className=\"absolute bottom-full left-0 mb-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-lg shadow-lg overflow-hidden z-50 min-w-[180px]\">\r\n                      <button\r\n                        onClick={() => {\r\n                          fileInputRef.current?.click()\r\n                          setShowUploadMenu(false)\r\n                        }}\r\n                        className=\"w-full px-4 py-2.5 flex items-center gap-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left\"\r\n                      >\r\n                        <Paperclip className=\"h-4 w-4 text-gray-600 dark:text-gray-400\" />\r\n                        <span className=\"text-sm text-gray-700 dark:text-gray-300\">Upload file</span>\r\n                      </button>\r\n                      <button\r\n                        onClick={() => {\r\n                          imageInputRef.current?.click()\r\n                          setShowUploadMenu(false)\r\n                        }}\r\n                        className=\"w-full px-4 py-2.5 flex items-center gap-3 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors text-left\"\r\n                      >\r\n                        <Image className=\"h-4 w-4 text-gray-600 dark:text-gray-400\" />\r\n                        <span className=\"text-sm text-gray-700 dark:text-gray-300\">Upload image</span>\r\n                      </button>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n                \r\n                <Textarea\r\n                  ref={textareaRef}\r\n                  value={inputMessage}\r\n                  onChange={handleInputChange}\r\n                  onKeyDown={handleKeyPress}\r\n                  placeholder={\r\n                    !isAuth\r\n                      ? \"You need to sign in to use the chatbot.\"\r\n                      : chatState === 'quizzing' \r\n                      ? \"Type your answer or ask a question...\" \r\n                      : chatState === 'completed'\r\n                      ? \"Ask me anything about the material...\"\r\n                      : \"Type a message...\"\r\n                  }\r\n                  rows={1}\r\n                  disabled={!isAuth}\r\n                  className={`resize-none min-h-11 max-h-32 overflow-y-auto bg-white dark:bg-[#212121] border-2 border-gray-300 dark:border-gray-600 text-gray-900 dark:text-white ${\r\n                    !isAuth ? \"cursor-not-allowed opacity-50\" : \"\"\r\n                  }`}\r\n                />\r\n                <Button \r\n                  onClick={handleSendMessage} \r\n                  disabled={!isAuth || !inputMessage.trim() || isLoading}\r\n                  className={`shrink-0 min-h-11 h-11 ${!isAuth ? \"cursor-not-allowed opacity-50\" : \"\"}`}\r\n                >\r\n                  {isAuth ? <Send className=\"h-4 w-4\" /> : <Lock className=\"h-4 w-4\" />}\r\n                </Button>\r\n              </div>\r\n              <p className=\"text-xs text-gray-500 dark:text-gray-400 text-center mt-2\">\r\n                {isAuth ? \"Press Enter to send, Shift+Enter for new line\" : \"Please sign in to start chatting\"}\r\n              </p>\r\n            </div>\r\n          </Card>\r\n        </div>\r\n      </main>\r\n      </div>\r\n    </div>\r\n  )\r\n}"],"names":[],"mappings":"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","debugId":null}}]
}